---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Sophie Boyd"
date: "2-26-26"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
```

### Instructional Staff Employment Trends

```{r read-staff-data}
staff <- read_csv("data/instructional-staff.csv")
```

```{r wide-to-long}
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
```

```{r line-graph}
staff_long %>%
  ggplot(aes(x = year, y = value, color = faculty_type)) +
  geom_line()
```

```{r line-graph-group}
staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  labs (x = "Year",
        y = "Percentage of Hires",
        title = "Percentage of Hires by Position (1975 to 2011)") +
  geom_line()
```

If the objective of this plot was to show that the proportion of part-time faculty had gone up compared to other positions, I would make all of the lines one color except for the part-time faculty line to make it stand out. I would also change the title to highlight the comparison between part-time hires and other positions.

### Fisheries

```{r read-fisheries-data}
fisheries <- read_csv("data/fisheries.csv")
```

```{r total-top-ten, warning=FALSE}
fisheries %>%
  summarize(country, total) %>%
  arrange(desc(total))
```


```{r filter-fisheries}
filtered_fisheries <- fisheries %>%
  filter(country %in% c("China", "Indonesia", "India", "Vietnam", "United States", "Russia", "Japan", "Philippines", "Peru", "Bangladesh"))
```

```{r fisheries-total-plot}
filtered_fisheries$country_ordered <- fct_relevel(filtered_fisheries$country, 'Bangladesh', 'Peru', 'Philippines', 'Japan', 'Russia', 'United States', 'Vietnam', 'India', 'Indonesia', 'China')

filtered_fisheries %>%
  ggplot(aes(
    x = country_ordered,
    y = total,
    color = country_ordered,
    fill = country_ordered
  )) +
  labs (x = 'Country',
        y = 'Total Harvest',
        color = 'Country',
        fill = 'Country',
        title = 'Total Harvest for Top 10 Countries') +
  geom_col(show.legend = FALSE) +
  coord_flip() 
```

```{r fisheries-capture-plot}
filtered_fisheries$country_ordered <- fct_relevel(filtered_fisheries$country, 'Bangladesh', 'Philippines', 'Vietnam', 'Japan', 'Peru', 'Russia', 'United States', 'India', 'Indonesia', 'China')
                                                  
filtered_fisheries %>%
  ggplot(aes(
    x = country_ordered,
    y = capture,
    color = country_ordered,
    fill = country_ordered
  )) +
  labs (x = 'Country',
        y = 'Capture',
        color = 'Country',
        fill = 'Country',
        title = 'Amount Captured for Top 10 Countries') +
  geom_col(show.legend = FALSE) +
  coord_flip()
```

```{r fisheries-aquaculture-plot}
filtered_fisheries$country_ordered <- fct_relevel(filtered_fisheries$country, 'Peru', 'Russia', 'United States', 'Japan', 'Bangladesh', 'Philippines', 'Vietnam', 'India', 'Indonesia', 'China')
                                                  
filtered_fisheries %>%
  ggplot(aes(
    x = country_ordered,
    y = aquaculture,
    color = country_ordered,
    fill = country_ordered
  )) +
  labs (x = 'Country',
        y = 'Aquaculture',
        color = 'Country',
        fill = 'Country',
        title = 'Amount Farmed for Top 10 Countries') +
  geom_col(show.legend = FALSE) +
  coord_flip() 
```

- I opted for bar graphs instead of the density distribution and donut charts to provide more clear comparisons of the harvest amounts between different countries. 

- I limited my sample to the 10 countries with the highest total harvest amounts to simplify the plots (but I realize that this results in some information lost). 

- I used coord_flip() to move the country names to the y-axis and make them more readable. 

- I assigned a distinct color to each country to create more contrast and assist with comparisons. 

- I removed the legend because it provided information about country that was redundant with the graph.


