---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Sophie Boyd"
date: "2-26-26"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
```

### Instructional Staff Employment Trends

```{r read-staff-data}
staff <- read_csv("data/instructional-staff.csv")
```

```{r wide-to-long}
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
```

```{r line-graph}
staff_long %>%
  ggplot(aes(x = year, y = value, color = faculty_type)) +
  geom_line()
```

```{r line-graph-group}
staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  labs (x = "Year",
        y = "Percentage of Hires",
        title = "Percentage of Hires by Position (1975 to 2011)") +
  geom_line()
```

If the objective of this plot was to show that the proportion of part-time faculty had gone up compared to other positions, I would make all of the lines one color except for the part-time faculty line to make it stand out. I would also change the title to highlight the comparison between part-time hires and other positions.

### Fisheries

To improve the first plot, I would change the scale on the y-axis or exclude a high outlier to make the trends at lower total harvest values more visible. I would also use a bar graph instead of a density distribution to provide a better comparison between the total harvests of different countries. For the other two plots, I would also opt for bar graphs instead of pie charts because they would be easier to read and I am personally more interested in comparisons between countries than contributions to the whole. 

```{r read-fisheries-data}
fisheries <- read_csv("data/fisheries.csv")
```

```{r filter-fisheries}
filtered_fisheries <- fisheries %>%
  filter(country %in% c("China", "Indonesia", "India", "Vietnam", "United States", "Russia", "Japan", "Philippines", "Peru", "Bangladesh"))
```

```{r fisheries-total-plot}
filtered_fisheries %>%
  ggplot(aes(
    x = country,
    y = total
  )) +
  geom_col() 
```

```{r fisheries-capture-plot}
filtered_fisheries %>%
  ggplot(aes(
    x = country,
    y = capture
  )) +
  geom_col()
```

```{r fisheries-aquaculture-plot}
filtered_fisheries %>%
  ggplot(aes(
    x = country,
    y = aquaculture
  )) +
  geom_col()
```




### Exercise 3

...

Add exercise headings as needed.
